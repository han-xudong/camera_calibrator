(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{4758:(e,r,t)=>{Promise.resolve().then(t.bind(t,8103)),Promise.resolve().then(t.bind(t,6722)),Promise.resolve().then(t.t.bind(t,6872,23))},6722:(e,r,t)=>{"use strict";t.d(r,{D:()=>n,ThemeProvider:()=>l});var o=t(5155),s=t(2115);let i=(0,s.createContext)(void 0);function l({children:e}){let[r,t]=(0,s.useState)("light");return(0,s.useEffect)(()=>{let e=localStorage.getItem("theme");e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches&&t("dark")},[]),(0,s.useEffect)(()=>{let e=window.document.documentElement;"dark"===r?e.classList.add("dark"):e.classList.remove("dark"),localStorage.setItem("theme",r)},[r]),(0,o.jsx)(i.Provider,{value:{theme:r,toggleTheme:()=>{t(e=>"light"===e?"dark":"light")}},children:e})}function n(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},6872:()=>{},8103:(e,r,t)=>{"use strict";t.d(r,{AprilTagProvider:()=>l,y:()=>n});var o=t(5155),s=t(2115);let i=(0,s.createContext)(null),l=({children:e})=>{let[r,l]=(0,s.useState)(!1),[n,a]=(0,s.useState)(null),u=(0,s.useRef)(null),c=(0,s.useRef)(new Map);(0,s.useEffect)(()=>{let e=new Worker(t.tu(new URL(t.p+t.u(98),t.b)));u.current=e,e.onmessage=e=>{let{type:r,id:t,payload:o,error:s}=e.data;if("INIT_SUCCESS"===r){console.log("Worker Init Success"),l(!0);let e=c.current.get(t);e&&e.resolve()}else if(s){console.error("Worker Error:",s),"ERROR"===r&&t&&t.startsWith("init_")&&a(s);let e=c.current.get(t);e&&e.reject(Error(s))}else{let e=c.current.get(t);e&&(e.resolve(o),c.current.delete(t))}},e.onerror=e=>{console.error("Worker script error:",e),a("Failed to load worker script.")};let r=`${window.location.origin}/camera_calibrator/apriltag.js`;console.log("[AprilTagProvider] Initializing worker with URL:",r);let o="init_"+Date.now();return c.current.set(o,{resolve:()=>{},reject:e=>a(e.message)}),e.postMessage({type:"INIT",id:o,payload:{url:r}}),()=>{e.terminate()}},[]);let d=(e,r)=>new Promise((t,o)=>{if(!u.current)return void o(Error("Worker not initialized"));let s=e+"_"+Date.now()+"_"+Math.random(),i=setTimeout(()=>{c.current.has(s)&&(c.current.delete(s),o(Error(`Worker timed out for ${e}`)))},6e4);c.current.set(s,{resolve:e=>{clearTimeout(i),t(e)},reject:e=>{clearTimeout(i),o(e)}}),u.current.postMessage({type:e,id:s,payload:r})}),m=async(e,r)=>d("DETECT",{imageData:e,settings:r}),h=async(e,r,t)=>d("CALIBRATE",{allImagePoints:e,objPoints:r,imageSize:t});return(0,o.jsx)(i.Provider,{value:{isReady:r,initError:n,detect:m,calibrate:h},children:e})},n=()=>{let e=(0,s.useContext)(i);if(!e)throw Error("useAprilTag must be used within an AprilTagProvider");return e}}},e=>{e.O(0,[513,441,794,358],()=>e(e.s=4758)),_N_E=e.O()}]);